define ("local_remote_backup_provider/list",["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(b,c){var d=b.find("tr:has(td)"),e=String.fromCharCode(11),f=String.fromCharCode(0),g="\""+d.map(function(b,c){var d=a(c),e=d.find("td.includeincsv");return e.map(function(b,c){var d=a(c),e=d.text();return e.replace(/"/g,"\"\"")}).get().join("\x0B")}).get().join("\0").split("\0").join("\"\r\n\"").split("\x0B").join("\",\"")+"\"";if(window.navigator.msSaveBlob){var h=new Blob([decodeURIComponent(g)],{type:"text/csv;charset=utf8"});window.navigator.msSaveBlob(h,c)}else if(window.Blob&&window.URL){var h=new Blob([g],{type:"text/csv;charset=utf-8"}),i=URL.createObjectURL(h);a(this).attr({download:c,href:i})}else{var j="data:application/csv;charset=utf-8,"+encodeURIComponent(g);a(this).attr({download:c,href:j,target:"_blank"})}};return{init:function init(){a(".rbp_dropdown").change(function(){var d=a(this).find(".optionvalue:selected"),e=a("#rbp_userrow_"+this.id),f=a("#tabletoexport").data("restoreid"),g={id:a(this).val(),username:d.data("username"),firstname:d.data("firstname"),lastname:d.data("lastname"),useremail:d.data("useremail")},h={id:this.id,username:e.data("username"),firstname:e.data("firstname"),lastname:e.data("lastname"),useremail:e.data("useremail")};if(!g.username){b.call([{methodname:"local_remote_backup_provider_update_user_entry_in_backup",args:{id:this.id,restoreid:f,username:h.username,firstname:h.firstname,lastname:h.lastname,useremail:h.useremail},done:function done(){e.find("td").eq(4).html("create as new user")},fail:c.exception}])}else{b.call([{methodname:"local_remote_backup_provider_update_user_entry_in_backup",args:{id:this.id,restoreid:f,username:g.username,firstname:g.firstname,lastname:g.lastname,useremail:g.useremail},done:function done(){e.find("td").eq(4).html("merge with existing user")},fail:c.exception}])}});a(".rbp_delete").click(function(){var d=a("#tabletoexport").data("restoreid"),e=this.id;b.call([{methodname:"local_remote_backup_provider_delete_user_entry_from_backup",args:{id:this.id,restoreid:d},done:function done(){a("#rbp_userrow_"+e).remove()},fail:c.exception}])});a("#linktodownload").click(function(){var b=[a("#tabletoexport>table"),"userlist.csv"];d.apply(this,b);alert("done")});a("#continue").click(function(){var d=a("#continue").data("href"),e=a("#tabletoexport").data("restoreid");b.call([{methodname:"local_remote_backup_provider_create_updated_backup",args:{restoreid:e},done:function done(){window.location=d+"&filename=updated_backup.mbz"},fail:c.exception}])})}}});
//# sourceMappingURL=list.min.js.map
