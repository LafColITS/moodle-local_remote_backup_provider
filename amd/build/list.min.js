define ("local_remote_backup_provider/list",["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(b,c){var d=b.find("tr:has(td)"),e=String.fromCharCode(11),f=String.fromCharCode(0),g="\""+d.map(function(b,c){var d=a(c),e=d.find("td.includeincsv");return e.map(function(b,c){var d=a(c),e=d.text();return e.replace(/"/g,"\"\"")}).get().join("\x0B")}).get().join("\0").split("\0").join("\"\r\n\"").split("\x0B").join("\",\"")+"\"";if(window.navigator.msSaveBlob){var h=new Blob([decodeURIComponent(g)],{type:"text/csv;charset=utf8"});window.navigator.msSaveBlob(h,c)}else if(window.Blob&&window.URL){var h=new Blob([g],{type:"text/csv;charset=utf-8"}),i=URL.createObjectURL(h);a(this).attr({download:c,href:i})}else{var j="data:application/csv;charset=utf-8,"+encodeURIComponent(g);a(this).attr({download:c,href:j,target:"_blank"})}},e=function(a,b){a.data("username",b.username);a.data("firstname",b.firstname);a.data("lastname",b.lastname);a.data("useremail",b.useremail)};return{init:function init(){a(".rbp_dropdown").change(function(){var b=a(this).find(".optionvalue:selected");if(b){var c={id:a(this).val(),username:b.data("username"),firstname:b.data("firstname"),lastname:b.data("lastname"),useremail:b.data("useremail")},d=a("#rbp_userrow_"+this.id),f={id:this.id,username:d.data("username"),firstname:d.data("firstname"),lastname:d.data("lastname"),useremail:d.data("useremail")};b.text(f.username+" "+f.firstname+" "+f.lastname+" "+f.useremail);d.find("td").eq(0).html(c.username);d.find("td").eq(1).html(c.firstname);d.find("td").eq(2).html(c.lastname);d.find("td").eq(3).html(c.useremail);e(d,c);e(b,f);var g=a(this).find(".blankvalue");g.text("Merged with existing user");g.attr("selected","selected");g.removeAttr("selected")}});a(".rbp_delete").click(function(){var d=a("#tabletoexport").data("restoreid"),e=a("#continue").attr("href");if(-1!=e.indexOf("&pathnamehash")){e=e.substring(0,e.indexOf("&pathnamehash"));e=e+"&filename=updated_backup.mbz"}var f=this.id;b.call([{methodname:"local_remote_backup_provider_delete_user_entry_from_backup",args:{id:this.id,restoreid:d},done:function done(){a("#continue").attr("href",e);a("#rbp_userrow_"+f).remove()},fail:c.exception}])});a("#linktodownload").click(function(){var b=[a("#tabletoexport>table"),"userlist.csv"];d.apply(this,b)})}}});
//# sourceMappingURL=list.min.js.map
